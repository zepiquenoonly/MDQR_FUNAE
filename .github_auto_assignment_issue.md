# Issue: Sistema de Classificação e Atribuição Automática de Reclamações

## Descrição
Implementar um sistema automático de classificação e atribuição de reclamações (grievances) aos técnicos disponíveis com base na carga de trabalho atual.

## Funcionalidades Requeridas

### 1. Classificação Automática por Tipo de Reclamação
- [ ] Classificar reclamações por categoria (Energia, Infraestrutura, Equipamento, etc.)
- [ ] Classificar por prioridade (baixa, média, alta, urgente)
- [ ] Classificar por localização (província, distrito)
- [ ] Sistema de pontuação para determinar especialização necessária

### 2. Sistema de Carga de Trabalho (Workload)
- [ ] Adicionar campo `workload_capacity` ao modelo User (capacidade máxima)
- [ ] Adicionar campo `current_workload` ao modelo User (carga atual)
- [ ] Adicionar campo `is_available` ao modelo User (disponibilidade)
- [ ] Calcular carga automática baseada em reclamações atribuídas e ativas
- [ ] Peso diferenciado por prioridade (urgente=4, alta=3, média=2, baixa=1)

### 3. Sistema de Especialização por Categoria
- [ ] Tabela pivot `user_specializations` (user_id, category, proficiency_level)
- [ ] Níveis: básico (1), intermediário (2), avançado (3), expert (4)
- [ ] Matching automático entre categoria de reclamação e especialização do técnico

### 4. Algoritmo de Atribuição Automática
- [ ] Service class `GrievanceAutoAssignmentService`
- [ ] Filtrar técnicos disponíveis (role='Técnico', is_available=true)
- [ ] Filtrar por especialização na categoria (se disponível)
- [ ] Filtrar por localização (província/distrito) quando relevante
- [ ] Ordenar por carga de trabalho (menor primeiro)
- [ ] Atribuir ao técnico com menor carga e especialização adequada
- [ ] Fallback: atribuir ao técnico com menor carga se nenhum especialista disponível

### 5. Triggers de Atribuição Automática
- [ ] Ao criar nova reclamação (status='submitted')
- [ ] Ao liberar técnico (status='resolved' ou 'rejected')
- [ ] Ao marcar técnico como disponível
- [ ] Comando artisan para reatribuição em massa de reclamações pendentes

### 6. Dashboard e Monitoramento
- [ ] Painel de carga de trabalho para gestores
- [ ] Visualização de disponibilidade dos técnicos
- [ ] Métricas: tempo médio de atribuição, distribuição de carga
- [ ] Alertas quando todos os técnicos estão sobrecarregados

### 7. Regras de Negócio
- [ ] Técnico não pode exceder `workload_capacity`
- [ ] Reclamações urgentes têm prioridade na atribuição
- [ ] Técnicos especializados têm preferência para suas categorias
- [ ] Técnicos da mesma região têm preferência
- [ ] Notificar técnico ao receber nova atribuição automática

## Estrutura Técnica

### Migrations
```
- add_workload_fields_to_users_table
- create_user_specializations_table
- add_auto_assignment_fields_to_grievances_table
```

### Models
```
- User (adicionar workload methods)
- UserSpecialization (novo)
- Grievance (adicionar assignment metadata)
```

### Services
```
- App\Services\GrievanceAutoAssignmentService
- App\Services\TechnicianWorkloadService
```

### Jobs/Events
```
- Jobs\AutoAssignGrievanceJob (queue)
- Events\GrievanceAutoAssigned
- Listeners\NotifyTechnicianOfAutoAssignment
```

### Commands
```
- php artisan grievance:auto-assign-pending
- php artisan grievance:rebalance-workload
```

## Prioridade
**Alta** - Esta funcionalidade é crítica para otimizar a distribuição de trabalho e reduzir tempo de resposta.

## Estimativa
5-7 dias de desenvolvimento + testes

## Notas Técnicas
- Usar filas (queues) para processamento assíncrono
- Implementar logs detalhados do processo de atribuição
- Adicionar testes unitários e de integração
- Considerar cache para cálculo de workload
- Implementar feature flag para ativar/desativar sistema automático

## Labels
`enhancement`, `auto-assignment`, `high-priority`, `technical-feature`
